## 如何设置线程数

参考公式：<font color="red">最佳线程数目 = （（线程等待时间+线程CPU时间）/线程CPU时间 ）* CPU数目</font>

举例：

服务器CPU核数为4核，一个任务线程cpu耗时为20ms，线程等待（网络IO、磁盘IO）耗时80ms，那最佳线程数目：( 80 + 20 )/20 * 4 = 20。也就是设置20个线程数最佳


> 线程的等待时间越大，线程数就要设置越大


### 处理任务

1. CPU 密集型任务

    比如像加**解密，压缩、计算**等一系列需要大量耗费 CPU 资源的任务，大部分场景下都是纯 CPU 计算

    操作内存处理的业务，一般线程数设置为：<font color="red">CPU核数 + 1 或者 CPU核数*2</font>。核数为4的话，一般设置 5 或 8

2. IO 密集型任务

    比如像 MySQL 数据库、文件的读写、网络通信等任务，这类任务不会特别消耗 CPU 资源，但是 IO 操作比较耗时，会占用比较多时间。

    文件操作，网络操作，数据库操作，一般线程设置为：<font color="red">cpu核数 / (1-0.9)</font>，核数为4的话，一般设置 40

